(function() {
  /*
  000   000  000  000   000  000      000   0000000  000000000  
  000 0 000  000  0000  000  000      000  000          000     
  000000000  000  000 0 000  000      000  0000000      000     
  000   000  000  000  0000  000      000       000     000     
  00     00  000  000   000  0000000  000  0000000      000     
  */
  var empty, ffi, log, ref, user, winList, wininfo;

  ({empty, log} = require('kxk'));

  ffi = require('ffi');

  ref = require('ref');

  user = require('./user');

  wininfo = require('./wininfo');

  winList = function() {
    var GW_OWNER, enumProc, windows;
    GW_OWNER = 4;
    windows = [];
    enumProc = ffi.Callback('int', ['pointer', 'pointer'], function(hWnd, lParam) {
      var ownerID, visible, win;
      ownerID = ref.address(user.GetWindow(hWnd, GW_OWNER));
      if (ownerID) {
        return 1;
      }
      visible = user.IsWindowVisible(hWnd);
      if (!visible) {
        return 1;
      }
      win = wininfo(hWnd);
      if (empty(win.title)) {
        return 1;
      }
      if (win.title === 'Program Manager') {
        return 1;
      }
      windows.push(win);
      return 1;
    });
    user.EnumWindows(enumProc, null);
    windows.sort(function(a, b) {
      return b.zOrder - a.zOrder;
    });
    return windows;
  };

  module.exports = winList;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lubGlzdC5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsianMvd2lubGlzdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUFBOzs7Ozs7O0FBQUEsTUFBQSxLQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE9BQUEsRUFBQTs7RUFRQSxDQUFBLENBQUUsS0FBRixFQUFTLEdBQVQsQ0FBQSxHQUFpQixPQUFBLENBQVEsS0FBUixDQUFqQjs7RUFFQSxHQUFBLEdBQVEsT0FBQSxDQUFRLEtBQVI7O0VBQ1IsR0FBQSxHQUFRLE9BQUEsQ0FBUSxLQUFSOztFQUVSLElBQUEsR0FBVSxPQUFBLENBQVEsUUFBUjs7RUFDVixPQUFBLEdBQVUsT0FBQSxDQUFRLFdBQVI7O0VBRVYsT0FBQSxHQUFVLFFBQUEsQ0FBQSxDQUFBO0FBRU4sUUFBQSxRQUFBLEVBQUEsUUFBQSxFQUFBO0lBQUEsUUFBQSxHQUFXO0lBRVgsT0FBQSxHQUFVO0lBRVYsUUFBQSxHQUFXLEdBQUcsQ0FBQyxRQUFKLENBQWEsS0FBYixFQUFvQixDQUFDLFNBQUQsRUFBWSxTQUFaLENBQXBCLEVBQTRDLFFBQUEsQ0FBQyxJQUFELEVBQU8sTUFBUCxDQUFBO0FBRW5ELFVBQUEsT0FBQSxFQUFBLE9BQUEsRUFBQTtNQUFBLE9BQUEsR0FBVSxHQUFHLENBQUMsT0FBSixDQUFZLElBQUksQ0FBQyxTQUFMLENBQWUsSUFBZixFQUFxQixRQUFyQixDQUFaO01BQ1YsSUFBRyxPQUFIO0FBQ0ksZUFBTyxFQURYOztNQUdBLE9BQUEsR0FBVSxJQUFJLENBQUMsZUFBTCxDQUFxQixJQUFyQjtNQUNWLElBQUcsQ0FBSSxPQUFQO0FBQ0ksZUFBTyxFQURYOztNQUdBLEdBQUEsR0FBTSxPQUFBLENBQVEsSUFBUjtNQUVOLElBQUcsS0FBQSxDQUFNLEdBQUcsQ0FBQyxLQUFWLENBQUg7QUFDSSxlQUFPLEVBRFg7O01BR0EsSUFBRyxHQUFHLENBQUMsS0FBSixLQUFhLGlCQUFoQjtBQUNJLGVBQU8sRUFEWDs7TUFHQSxPQUFPLENBQUMsSUFBUixDQUFhLEdBQWI7QUFFQSxhQUFPO0lBcEI0QyxDQUE1QztJQXNCWCxJQUFJLENBQUMsV0FBTCxDQUFpQixRQUFqQixFQUEyQixJQUEzQjtJQUNBLE9BQU8sQ0FBQyxJQUFSLENBQWEsUUFBQSxDQUFDLENBQUQsRUFBRyxDQUFILENBQUE7YUFBUyxDQUFDLENBQUMsTUFBRixHQUFXLENBQUMsQ0FBQztJQUF0QixDQUFiO1dBQ0E7RUE5Qk07O0VBZ0NWLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0FBaERqQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAwICBcbjAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgXG4wMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgIFxuMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgICBcbjAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgIDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgXG4jIyNcblxueyBlbXB0eSwgbG9nIH0gPSByZXF1aXJlICdreGsnXG5cbmZmaSAgID0gcmVxdWlyZSAnZmZpJ1xucmVmICAgPSByZXF1aXJlICdyZWYnXG5cbnVzZXIgICAgPSByZXF1aXJlICcuL3VzZXInXG53aW5pbmZvID0gcmVxdWlyZSAnLi93aW5pbmZvJ1xuXG53aW5MaXN0ID0gLT5cbiAgICAgXG4gICAgR1dfT1dORVIgPSA0XG4gICAgXG4gICAgd2luZG93cyA9IFtdXG4gICAgXG4gICAgZW51bVByb2MgPSBmZmkuQ2FsbGJhY2sgJ2ludCcsIFsncG9pbnRlcicsICdwb2ludGVyJ10sIChoV25kLCBsUGFyYW0pIC0+XG4gICAgXG4gICAgICAgIG93bmVySUQgPSByZWYuYWRkcmVzcyB1c2VyLkdldFdpbmRvdyBoV25kLCBHV19PV05FUlxuICAgICAgICBpZiBvd25lcklEXG4gICAgICAgICAgICByZXR1cm4gMVxuICBcbiAgICAgICAgdmlzaWJsZSA9IHVzZXIuSXNXaW5kb3dWaXNpYmxlIGhXbmRcbiAgICAgICAgaWYgbm90IHZpc2libGVcbiAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgIFxuICAgICAgICB3aW4gPSB3aW5pbmZvIGhXbmRcbiAgICAgICAgXG4gICAgICAgIGlmIGVtcHR5IHdpbi50aXRsZVxuICAgICAgICAgICAgcmV0dXJuIDFcbiAgICAgICAgICAgIFxuICAgICAgICBpZiB3aW4udGl0bGUgPT0gJ1Byb2dyYW0gTWFuYWdlcidcbiAgICAgICAgICAgIHJldHVybiAxXG4gICAgICAgIFxuICAgICAgICB3aW5kb3dzLnB1c2ggd2luXG4gICAgICAgICAgICBcbiAgICAgICAgcmV0dXJuIDFcbiAgICBcbiAgICB1c2VyLkVudW1XaW5kb3dzIGVudW1Qcm9jLCBudWxsXG4gICAgd2luZG93cy5zb3J0IChhLGIpIC0+IGIuek9yZGVyIC0gYS56T3JkZXJcbiAgICB3aW5kb3dzXG4gICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSB3aW5MaXN0XG4iXX0=
//# sourceURL=C:/Users/kodi/s/wxw/coffee/winlist.coffee