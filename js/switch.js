// koffee 1.3.0
var $, activate, activeApp, childp, clamp, done, drag, electron, elem, empty, getApps, highlight, initWin, karg, keyinfo, klog, kpos, loadApps, nextApp, onKeyDown, onKeyUp, onMouseDown, onMouseMove, pngPath, post, prefs, prevApp, quitApp, ref, slash, start, wc,
    indexOf = [].indexOf;

ref = require('kxk'), childp = ref.childp, post = ref.post, karg = ref.karg, slash = ref.slash, drag = ref.drag, elem = ref.elem, prefs = ref.prefs, clamp = ref.clamp, kpos = ref.kpos, empty = ref.empty, klog = ref.klog, keyinfo = ref.keyinfo, $ = ref.$;

wc = require('./wc');

electron = require('electron');

getApps = function() {
    var apps, i, info, infos, len, ref1;
    infos = wc('info');
    apps = [];
    for (i = 0, len = infos.length; i < len; i++) {
        info = infos[i];
        if (info.title !== 'wxw-switch') {
            if (ref1 = info.path, indexOf.call(apps, ref1) < 0) {
                apps.push(info.path);
            }
        }
    }
    return apps;
};

pngPath = function(appPath) {
    return slash.resolve(slash.join(slash.userData(), 'icons', slash.base(appPath) + ".png"));
};

start = function(opt) {
    var app, apps, as, border, data, height, html, i, len, png, ss, width, win;
    if (opt == null) {
        opt = {};
    }
    ss = electron.screen.getPrimaryDisplay().workAreaSize;
    as = 128;
    border = 20;
    apps = getApps();
    for (i = 0, len = apps.length; i < len; i++) {
        app = apps[i];
        png = pngPath(slash.base(app));
        if (!slash.fileExists(png)) {
            klog('icon', app, png);
            wc('icon', app, png);
        }
    }
    width = (as + border) * apps.length + border;
    height = as + border * 2;
    win = new electron.BrowserWindow({
        backgroundColor: '#00000000',
        transparent: true,
        preloadWindow: true,
        x: parseInt((ss.width - width) / 2),
        y: parseInt((ss.height - height) / 2),
        width: width,
        height: height,
        hasShadow: false,
        resizable: false,
        frame: false,
        thickFrame: false,
        fullscreen: false,
        show: true,
        webPreferences: {
            nodeIntegration: true,
            webSecurity: false
        }
    });
    html = "<head>\n<title>wxw-switch</title>\n<style type=\"text/css\">\n    * {\n        outline-width:  0;\n    }\n    \n    body {\n        overflow:       hidden;\n        margin:         0;\n    }\n    .apps {\n        opacity:        1;\n        white-space:    nowrap;\n        position:       absolute;\n        left:           0px;\n        top:            0px;\n        bottom:         0px;\n        right:          0px;\n        overflow:       hidden;\n        background:     rgb(16,16,16);\n        border-radius:  6px;\n        padding:        10px;\n    }\n    .app {\n        display:        inline-block;\n        width:          128px;\n        height:         128px;\n        padding:        10px;\n    }            \n    .app.highlight {\n        background:     rgb(24,24,24);\n    }\n</style>\n</head>\n<body>\n<div class=\"apps\" tabindex=0></div>\n<script>\n    var pth = process.resourcesPath + \"/app/js/switch.js\";\n    if (process.resourcesPath.indexOf(\"node_modules\\\\electron\\\\dist\\\\resources\")>=0) { pth = process.cwd() + \"/js/switch.js\"; }\n    console.log(pth, process.resourcesPath);\n    require(pth).initWin();\n</script>\n</body>";
    data = "data:text/html;charset=utf-8," + encodeURI(html);
    win.loadURL(data, {
        baseURLForDataURL: slash.fileUrl(__dirname + '/index.html')
    });
    win.debug = opt.debug;
    if (opt.debug) {
        win.webContents.openDevTools();
    }
    return win;
};

done = function() {
    return electron.remote.getCurrentWindow().hide();
};

activeApp = null;

highlight = function(e) {
    if (e.id) {
        if (activeApp != null) {
            activeApp.classList.remove('highlight');
        }
        e.classList.add('highlight');
        return activeApp = e;
    }
};

activate = function() {
    done();
    if (activeApp.id) {
        return wc('focus', activeApp.id);
    }
};

nextApp = function() {
    return highlight(activeApp.nextSibling);
};

prevApp = function() {
    return highlight(activeApp.previousSibling);
};

quitApp = function() {
    return klog('quitApp', activeApp.id);
};

onMouseMove = function(event) {
    return highlight(event.target);
};

onMouseDown = function(event) {
    activeApp = event.target;
    return activate();
};

onKeyDown = function(event) {
    var char, combo, key, mod, ref1;
    ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, char = ref1.char, combo = ref1.combo;
    switch (key) {
        case 'esc':
            done();
            break;
        case 'right':
            nextApp();
            break;
        case 'left':
            prevApp();
            break;
        case 'q':
            quitApp();
            break;
        case 'enter':
        case 'return':
        case 'space':
            activate();
            break;
        default:
            klog('onKeyDown', combo);
    }
    switch (combo) {
        case 'ctrl+shift+tab':
            return prevApp();
        case 'alt+ctrl+q':
            return electron.remote.app.quit();
    }
};

onKeyUp = function(event) {
    var char, combo, key, mod, ref1;
    ref1 = keyinfo.forEvent(event), mod = ref1.mod, key = ref1.key, char = ref1.char, combo = ref1.combo;
    if (empty(combo)) {
        return activate();
    }
};

initWin = function() {
    var a, win;
    win = electron.remote.getCurrentWindow();
    a = $('.apps');
    a.onmousemove = onMouseMove;
    a.onmousedown = onMouseDown;
    a.onkeydown = onKeyDown;
    a.onkeyup = onKeyUp;
    loadApps();
    return post.on('nextApp', function() {
        if (win.isVisible()) {
            return nextApp();
        } else {
            a = $('.apps');
            a.innerHTML = '';
            win.show();
            return loadApps();
        }
    });
};

loadApps = function() {
    var a, i, len, p, ref1, ref2;
    a = $('.apps');
    a.innerHTML = '';
    ref1 = getApps();
    for (i = 0, len = ref1.length; i < len; i++) {
        p = ref1[i];
        a.appendChild(elem('img', {
            id: p,
            "class": 'app',
            src: slash.fileUrl(pngPath(p))
        }));
    }
    a.focus();
    return highlight((ref2 = a.firstChild.nextSibling) != null ? ref2 : a.firstChild);
};

module.exports = {
    start: start,
    initWin: initWin
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dpdGNoLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBTUEsSUFBQSxnUUFBQTtJQUFBOztBQUFBLE1BQXlGLE9BQUEsQ0FBUSxLQUFSLENBQXpGLEVBQUUsbUJBQUYsRUFBVSxlQUFWLEVBQWdCLGVBQWhCLEVBQXNCLGlCQUF0QixFQUE2QixlQUE3QixFQUFtQyxlQUFuQyxFQUF5QyxpQkFBekMsRUFBZ0QsaUJBQWhELEVBQXVELGVBQXZELEVBQTZELGlCQUE3RCxFQUFvRSxlQUFwRSxFQUEwRSxxQkFBMUUsRUFBbUY7O0FBRW5GLEVBQUEsR0FBSyxPQUFBLENBQVEsTUFBUjs7QUFDTCxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7O0FBUVgsT0FBQSxHQUFVLFNBQUE7QUFFTixRQUFBO0lBQUEsS0FBQSxHQUFRLEVBQUEsQ0FBRyxNQUFIO0lBRVIsSUFBQSxHQUFPO0FBQ1AsU0FBQSx1Q0FBQTs7UUFDSSxJQUFHLElBQUksQ0FBQyxLQUFMLEtBQWMsWUFBakI7WUFDSSxXQUF1QixJQUFJLENBQUMsSUFBTCxFQUFBLGFBQWlCLElBQWpCLEVBQUEsSUFBQSxLQUF2QjtnQkFBQSxJQUFJLENBQUMsSUFBTCxDQUFVLElBQUksQ0FBQyxJQUFmLEVBQUE7YUFESjs7QUFESjtXQUlBO0FBVE07O0FBaUJWLE9BQUEsR0FBVSxTQUFDLE9BQUQ7V0FFTixLQUFLLENBQUMsT0FBTixDQUFjLEtBQUssQ0FBQyxJQUFOLENBQVcsS0FBSyxDQUFDLFFBQU4sQ0FBQSxDQUFYLEVBQTZCLE9BQTdCLEVBQXNDLEtBQUssQ0FBQyxJQUFOLENBQVcsT0FBWCxDQUFBLEdBQXNCLE1BQTVELENBQWQ7QUFGTTs7QUFVVixLQUFBLEdBQVEsU0FBQyxHQUFEO0FBRUosUUFBQTs7UUFGSyxNQUFJOztJQUVULEVBQUEsR0FBSyxRQUFRLENBQUMsTUFBTSxDQUFDLGlCQUFoQixDQUFBLENBQW1DLENBQUM7SUFFekMsRUFBQSxHQUFLO0lBQ0wsTUFBQSxHQUFTO0lBRVQsSUFBQSxHQUFPLE9BQUEsQ0FBQTtBQUVQLFNBQUEsc0NBQUE7O1FBQ0ksR0FBQSxHQUFNLE9BQUEsQ0FBUSxLQUFLLENBQUMsSUFBTixDQUFXLEdBQVgsQ0FBUjtRQUNOLElBQUcsQ0FBSSxLQUFLLENBQUMsVUFBTixDQUFpQixHQUFqQixDQUFQO1lBQ0ksSUFBQSxDQUFLLE1BQUwsRUFBWSxHQUFaLEVBQWlCLEdBQWpCO1lBQ0EsRUFBQSxDQUFHLE1BQUgsRUFBVSxHQUFWLEVBQWUsR0FBZixFQUZKOztBQUZKO0lBTUEsS0FBQSxHQUFRLENBQUMsRUFBQSxHQUFHLE1BQUosQ0FBQSxHQUFZLElBQUksQ0FBQyxNQUFqQixHQUF3QjtJQUNoQyxNQUFBLEdBQVMsRUFBQSxHQUFHLE1BQUEsR0FBTztJQUVuQixHQUFBLEdBQU0sSUFBSSxRQUFRLENBQUMsYUFBYixDQUVGO1FBQUEsZUFBQSxFQUFpQixXQUFqQjtRQUNBLFdBQUEsRUFBaUIsSUFEakI7UUFFQSxhQUFBLEVBQWlCLElBRmpCO1FBR0EsQ0FBQSxFQUFpQixRQUFBLENBQVMsQ0FBQyxFQUFFLENBQUMsS0FBSCxHQUFTLEtBQVYsQ0FBQSxHQUFpQixDQUExQixDQUhqQjtRQUlBLENBQUEsRUFBaUIsUUFBQSxDQUFTLENBQUMsRUFBRSxDQUFDLE1BQUgsR0FBVSxNQUFYLENBQUEsR0FBbUIsQ0FBNUIsQ0FKakI7UUFLQSxLQUFBLEVBQWlCLEtBTGpCO1FBTUEsTUFBQSxFQUFpQixNQU5qQjtRQU9BLFNBQUEsRUFBaUIsS0FQakI7UUFRQSxTQUFBLEVBQWlCLEtBUmpCO1FBU0EsS0FBQSxFQUFpQixLQVRqQjtRQVVBLFVBQUEsRUFBaUIsS0FWakI7UUFXQSxVQUFBLEVBQWlCLEtBWGpCO1FBWUEsSUFBQSxFQUFpQixJQVpqQjtRQWFBLGNBQUEsRUFDSTtZQUFBLGVBQUEsRUFBaUIsSUFBakI7WUFDQSxXQUFBLEVBQWlCLEtBRGpCO1NBZEo7S0FGRTtJQXlCTixJQUFBLEdBQU87SUErQ1AsSUFBQSxHQUFPLCtCQUFBLEdBQWtDLFNBQUEsQ0FBVSxJQUFWO0lBQ3pDLEdBQUcsQ0FBQyxPQUFKLENBQVksSUFBWixFQUFrQjtRQUFBLGlCQUFBLEVBQWtCLEtBQUssQ0FBQyxPQUFOLENBQWMsU0FBQSxHQUFZLGFBQTFCLENBQWxCO0tBQWxCO0lBRUEsR0FBRyxDQUFDLEtBQUosR0FBWSxHQUFHLENBQUM7SUFFaEIsSUFBRyxHQUFHLENBQUMsS0FBUDtRQUNJLEdBQUcsQ0FBQyxXQUFXLENBQUMsWUFBaEIsQ0FBQSxFQURKOztXQUVBO0FBakdJOztBQXlHUixJQUFBLEdBQU8sU0FBQTtXQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsZ0JBQWhCLENBQUEsQ0FBa0MsQ0FBQyxJQUFuQyxDQUFBO0FBQUg7O0FBUVAsU0FBQSxHQUFZOztBQUVaLFNBQUEsR0FBWSxTQUFDLENBQUQ7SUFDUixJQUFHLENBQUMsQ0FBQyxFQUFMOztZQUNJLFNBQVMsQ0FBRSxTQUFTLENBQUMsTUFBckIsQ0FBNEIsV0FBNUI7O1FBQ0EsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFaLENBQWdCLFdBQWhCO2VBQ0EsU0FBQSxHQUFZLEVBSGhCOztBQURROztBQU1aLFFBQUEsR0FBVyxTQUFBO0lBQ1AsSUFBQSxDQUFBO0lBQ0EsSUFBMkIsU0FBUyxDQUFDLEVBQXJDO2VBQUEsRUFBQSxDQUFHLE9BQUgsRUFBVyxTQUFTLENBQUMsRUFBckIsRUFBQTs7QUFGTzs7QUFJWCxPQUFBLEdBQVUsU0FBQTtXQUFHLFNBQUEsQ0FBVSxTQUFTLENBQUMsV0FBcEI7QUFBSDs7QUFDVixPQUFBLEdBQVUsU0FBQTtXQUFHLFNBQUEsQ0FBVSxTQUFTLENBQUMsZUFBcEI7QUFBSDs7QUFDVixPQUFBLEdBQVUsU0FBQTtXQUFHLElBQUEsQ0FBSyxTQUFMLEVBQWUsU0FBUyxDQUFDLEVBQXpCO0FBQUg7O0FBUVYsV0FBQSxHQUFjLFNBQUMsS0FBRDtXQUFXLFNBQUEsQ0FBVSxLQUFLLENBQUMsTUFBaEI7QUFBWDs7QUFFZCxXQUFBLEdBQWMsU0FBQyxLQUFEO0lBQ1YsU0FBQSxHQUFZLEtBQUssQ0FBQztXQUNsQixRQUFBLENBQUE7QUFGVTs7QUFVZCxTQUFBLEdBQVksU0FBQyxLQUFEO0FBRVIsUUFBQTtJQUFBLE9BQTRCLE9BQU8sQ0FBQyxRQUFSLENBQWlCLEtBQWpCLENBQTVCLEVBQUUsY0FBRixFQUFPLGNBQVAsRUFBWSxnQkFBWixFQUFrQjtBQUVsQixZQUFPLEdBQVA7QUFBQSxhQUNTLEtBRFQ7WUFDc0IsSUFBQSxDQUFBO0FBQWI7QUFEVCxhQUVTLE9BRlQ7WUFFc0IsT0FBQSxDQUFBO0FBQWI7QUFGVCxhQUdTLE1BSFQ7WUFHc0IsT0FBQSxDQUFBO0FBQWI7QUFIVCxhQUlTLEdBSlQ7WUFJc0IsT0FBQSxDQUFBO0FBQWI7QUFKVCxhQUtTLE9BTFQ7QUFBQSxhQUtpQixRQUxqQjtBQUFBLGFBSzBCLE9BTDFCO1lBS3VDLFFBQUEsQ0FBQTtBQUFiO0FBTDFCO1lBTVMsSUFBQSxDQUFLLFdBQUwsRUFBaUIsS0FBakI7QUFOVDtBQVFBLFlBQU8sS0FBUDtBQUFBLGFBQ1MsZ0JBRFQ7bUJBQytCLE9BQUEsQ0FBQTtBQUQvQixhQUVTLFlBRlQ7bUJBRStCLFFBQVEsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQXBCLENBQUE7QUFGL0I7QUFaUTs7QUFnQlosT0FBQSxHQUFVLFNBQUMsS0FBRDtBQUVOLFFBQUE7SUFBQSxPQUE0QixPQUFPLENBQUMsUUFBUixDQUFpQixLQUFqQixDQUE1QixFQUFFLGNBQUYsRUFBTyxjQUFQLEVBQVksZ0JBQVosRUFBa0I7SUFFbEIsSUFBRyxLQUFBLENBQU0sS0FBTixDQUFIO2VBQ0ksUUFBQSxDQUFBLEVBREo7O0FBSk07O0FBYVYsT0FBQSxHQUFVLFNBQUE7QUFFTixRQUFBO0lBQUEsR0FBQSxHQUFNLFFBQVEsQ0FBQyxNQUFNLENBQUMsZ0JBQWhCLENBQUE7SUFFTixDQUFBLEdBQUcsQ0FBQSxDQUFFLE9BQUY7SUFFSCxDQUFDLENBQUMsV0FBRixHQUFnQjtJQUNoQixDQUFDLENBQUMsV0FBRixHQUFnQjtJQUNoQixDQUFDLENBQUMsU0FBRixHQUFnQjtJQUNoQixDQUFDLENBQUMsT0FBRixHQUFnQjtJQUtoQixRQUFBLENBQUE7V0FFQSxJQUFJLENBQUMsRUFBTCxDQUFRLFNBQVIsRUFBa0IsU0FBQTtRQUVkLElBQUcsR0FBRyxDQUFDLFNBQUosQ0FBQSxDQUFIO21CQUNJLE9BQUEsQ0FBQSxFQURKO1NBQUEsTUFBQTtZQUdJLENBQUEsR0FBRyxDQUFBLENBQUUsT0FBRjtZQUNILENBQUMsQ0FBQyxTQUFGLEdBQWM7WUFDZCxHQUFHLENBQUMsSUFBSixDQUFBO21CQUNBLFFBQUEsQ0FBQSxFQU5KOztJQUZjLENBQWxCO0FBaEJNOztBQWdDVixRQUFBLEdBQVcsU0FBQTtBQUVQLFFBQUE7SUFBQSxDQUFBLEdBQUcsQ0FBQSxDQUFFLE9BQUY7SUFDSCxDQUFDLENBQUMsU0FBRixHQUFjO0FBRWQ7QUFBQSxTQUFBLHNDQUFBOztRQUNJLENBQUMsQ0FBQyxXQUFGLENBQWMsSUFBQSxDQUFLLEtBQUwsRUFDVjtZQUFBLEVBQUEsRUFBSSxDQUFKO1lBQ0EsQ0FBQSxLQUFBLENBQUEsRUFBTSxLQUROO1lBRUEsR0FBQSxFQUFJLEtBQUssQ0FBQyxPQUFOLENBQWMsT0FBQSxDQUFRLENBQVIsQ0FBZCxDQUZKO1NBRFUsQ0FBZDtBQURKO0lBTUEsQ0FBQyxDQUFDLEtBQUYsQ0FBQTtXQUVBLFNBQUEsb0RBQXFDLENBQUMsQ0FBQyxVQUF2QztBQWJPOztBQWVYLE1BQU0sQ0FBQyxPQUFQLEdBQ0k7SUFBQSxLQUFBLEVBQU0sS0FBTjtJQUNBLE9BQUEsRUFBUSxPQURSIiwic291cmNlc0NvbnRlbnQiOlsiIyAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAwMDAwMDAgIFxuIyAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMCAgICAgMDAgIDAwMCAgICAgMDAwICAgICAgMDAwMDAwMCAgMDAwICAgMDAwICBcblxueyBjaGlsZHAsIHBvc3QsIGthcmcsIHNsYXNoLCBkcmFnLCBlbGVtLCBwcmVmcywgY2xhbXAsIGtwb3MsIGVtcHR5LCBrbG9nLCBrZXlpbmZvLCAkIH0gPSByZXF1aXJlICdreGsnXG5cbndjID0gcmVxdWlyZSAnLi93YydcbmVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG5cbiMgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAwICAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgICAwMDAwMDAwICBcbiMgMDAwICAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAwMDAwICAwMDAwMDAwICAgICAgMDAwICAgICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgICAgICAgMDAwICBcbiMgIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgIDAwMDAwMDAgICBcblxuZ2V0QXBwcyA9IC0+XG5cbiAgICBpbmZvcyA9IHdjICdpbmZvJ1xuICAgIFxuICAgIGFwcHMgPSBbXVxuICAgIGZvciBpbmZvIGluIGluZm9zXG4gICAgICAgIGlmIGluZm8udGl0bGUgIT0gJ3d4dy1zd2l0Y2gnXG4gICAgICAgICAgICBhcHBzLnB1c2ggaW5mby5wYXRoIGlmIGluZm8ucGF0aCBub3QgaW4gYXBwc1xuICAgICAgICAgICAgXG4gICAgYXBwc1xuICAgIFxuIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAgXG4jIDAwMDAwMDAwICAgMDAwIDAgMDAwICAwMDAgIDAwMDAgIFxuIyAwMDAgICAgICAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgXG5cbnBuZ1BhdGggPSAoYXBwUGF0aCkgLT5cbiAgICAjIGtsb2cgJ2FwcFBhdGgnIGFwcFBhdGgsIHNsYXNoLmJhc2UoYXBwUGF0aClcbiAgICBzbGFzaC5yZXNvbHZlIHNsYXNoLmpvaW4gc2xhc2gudXNlckRhdGEoKSwgJ2ljb25zJywgc2xhc2guYmFzZShhcHBQYXRoKSArIFwiLnBuZ1wiXG4gICAgXG4jICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgICAgIDAwMCAgICAgXG4jICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcblxuc3RhcnQgPSAob3B0PXt9KSAtPiBcblxuICAgIHNzID0gZWxlY3Ryb24uc2NyZWVuLmdldFByaW1hcnlEaXNwbGF5KCkud29ya0FyZWFTaXplXG4gICAgXG4gICAgYXMgPSAxMjhcbiAgICBib3JkZXIgPSAyMFxuICAgIFxuICAgIGFwcHMgPSBnZXRBcHBzKClcbiAgICBcbiAgICBmb3IgYXBwIGluIGFwcHNcbiAgICAgICAgcG5nID0gcG5nUGF0aCBzbGFzaC5iYXNlIGFwcFxuICAgICAgICBpZiBub3Qgc2xhc2guZmlsZUV4aXN0cyBwbmdcbiAgICAgICAgICAgIGtsb2cgJ2ljb24nIGFwcCwgcG5nXG4gICAgICAgICAgICB3YyAnaWNvbicgYXBwLCBwbmdcbiAgICBcbiAgICB3aWR0aCA9IChhcytib3JkZXIpKmFwcHMubGVuZ3RoK2JvcmRlclxuICAgIGhlaWdodCA9IGFzK2JvcmRlcioyXG4gICAgICAgICAgICBcbiAgICB3aW4gPSBuZXcgZWxlY3Ryb24uQnJvd3NlcldpbmRvd1xuXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogJyMwMDAwMDAwMCdcbiAgICAgICAgdHJhbnNwYXJlbnQ6ICAgICB0cnVlXG4gICAgICAgIHByZWxvYWRXaW5kb3c6ICAgdHJ1ZVxuICAgICAgICB4OiAgICAgICAgICAgICAgIHBhcnNlSW50IChzcy53aWR0aC13aWR0aCkvMlxuICAgICAgICB5OiAgICAgICAgICAgICAgIHBhcnNlSW50IChzcy5oZWlnaHQtaGVpZ2h0KS8yXG4gICAgICAgIHdpZHRoOiAgICAgICAgICAgd2lkdGhcbiAgICAgICAgaGVpZ2h0OiAgICAgICAgICBoZWlnaHRcbiAgICAgICAgaGFzU2hhZG93OiAgICAgICBmYWxzZVxuICAgICAgICByZXNpemFibGU6ICAgICAgIGZhbHNlXG4gICAgICAgIGZyYW1lOiAgICAgICAgICAgZmFsc2VcbiAgICAgICAgdGhpY2tGcmFtZTogICAgICBmYWxzZVxuICAgICAgICBmdWxsc2NyZWVuOiAgICAgIGZhbHNlXG4gICAgICAgIHNob3c6ICAgICAgICAgICAgdHJ1ZVxuICAgICAgICB3ZWJQcmVmZXJlbmNlczpcbiAgICAgICAgICAgIG5vZGVJbnRlZ3JhdGlvbjogdHJ1ZVxuICAgICAgICAgICAgd2ViU2VjdXJpdHk6ICAgICBmYWxzZVxuICAgICAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAgICAgIDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwIDAgMDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgIFxuICAgIFxuICAgIGh0bWwgPSBcIlwiXCJcbiAgICAgICAgPGhlYWQ+XG4gICAgICAgIDx0aXRsZT53eHctc3dpdGNoPC90aXRsZT5cbiAgICAgICAgPHN0eWxlIHR5cGU9XCJ0ZXh0L2Nzc1wiPlxuICAgICAgICAgICAgKiB7XG4gICAgICAgICAgICAgICAgb3V0bGluZS13aWR0aDogIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGJvZHkge1xuICAgICAgICAgICAgICAgIG92ZXJmbG93OiAgICAgICBoaWRkZW47XG4gICAgICAgICAgICAgICAgbWFyZ2luOiAgICAgICAgIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAuYXBwcyB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogICAgICAgIDE7XG4gICAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6ICAgIG5vd3JhcDtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogICAgICAgYWJzb2x1dGU7XG4gICAgICAgICAgICAgICAgbGVmdDogICAgICAgICAgIDBweDtcbiAgICAgICAgICAgICAgICB0b3A6ICAgICAgICAgICAgMHB4O1xuICAgICAgICAgICAgICAgIGJvdHRvbTogICAgICAgICAwcHg7XG4gICAgICAgICAgICAgICAgcmlnaHQ6ICAgICAgICAgIDBweDtcbiAgICAgICAgICAgICAgICBvdmVyZmxvdzogICAgICAgaGlkZGVuO1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICAgICByZ2IoMTYsMTYsMTYpO1xuICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6ICA2cHg7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogICAgICAgIDEwcHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAuYXBwIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiAgICAgICAgaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgICAgIHdpZHRoOiAgICAgICAgICAxMjhweDtcbiAgICAgICAgICAgICAgICBoZWlnaHQ6ICAgICAgICAgMTI4cHg7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogICAgICAgIDEwcHg7XG4gICAgICAgICAgICB9ICAgICAgICAgICAgXG4gICAgICAgICAgICAuYXBwLmhpZ2hsaWdodCB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogICAgIHJnYigyNCwyNCwyNCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIDwvc3R5bGU+XG4gICAgICAgIDwvaGVhZD5cbiAgICAgICAgPGJvZHk+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJhcHBzXCIgdGFiaW5kZXg9MD48L2Rpdj5cbiAgICAgICAgPHNjcmlwdD5cbiAgICAgICAgICAgIHZhciBwdGggPSBwcm9jZXNzLnJlc291cmNlc1BhdGggKyBcIi9hcHAvanMvc3dpdGNoLmpzXCI7XG4gICAgICAgICAgICBpZiAocHJvY2Vzcy5yZXNvdXJjZXNQYXRoLmluZGV4T2YoXCJub2RlX21vZHVsZXNcXFxcXFxcXGVsZWN0cm9uXFxcXFxcXFxkaXN0XFxcXFxcXFxyZXNvdXJjZXNcIik+PTApIHsgcHRoID0gcHJvY2Vzcy5jd2QoKSArIFwiL2pzL3N3aXRjaC5qc1wiOyB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwdGgsIHByb2Nlc3MucmVzb3VyY2VzUGF0aCk7XG4gICAgICAgICAgICByZXF1aXJlKHB0aCkuaW5pdFdpbigpO1xuICAgICAgICA8L3NjcmlwdD5cbiAgICAgICAgPC9ib2R5PlxuICAgIFwiXCJcIlxuXG4gICAgZGF0YSA9IFwiZGF0YTp0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCxcIiArIGVuY29kZVVSSShodG1sKVxuICAgIHdpbi5sb2FkVVJMIGRhdGEsIGJhc2VVUkxGb3JEYXRhVVJMOnNsYXNoLmZpbGVVcmwgX19kaXJuYW1lICsgJy9pbmRleC5odG1sJ1xuXG4gICAgd2luLmRlYnVnID0gb3B0LmRlYnVnXG4gICAgXG4gICAgaWYgb3B0LmRlYnVnXG4gICAgICAgIHdpbi53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKVxuICAgIHdpblxuICAgICAgICBcbiMgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgMCAwMDAgIDAwMDAwMDAgICBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIFxuIyAwMDAwMDAwICAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG5cbmRvbmUgPSAtPiBlbGVjdHJvbi5yZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpLmhpZGUoKVxuXG4jICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwICAgXG4jIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAwICAgICAgMDAwMDAwMDAgIFxuXG5hY3RpdmVBcHAgPSBudWxsXG5cbmhpZ2hsaWdodCA9IChlKSAtPlxuICAgIGlmIGUuaWRcbiAgICAgICAgYWN0aXZlQXBwPy5jbGFzc0xpc3QucmVtb3ZlICdoaWdobGlnaHQnXG4gICAgICAgIGUuY2xhc3NMaXN0LmFkZCAnaGlnaGxpZ2h0J1xuICAgICAgICBhY3RpdmVBcHAgPSBlXG5cbmFjdGl2YXRlID0gLT5cbiAgICBkb25lKClcbiAgICB3YyAnZm9jdXMnIGFjdGl2ZUFwcC5pZCBpZiBhY3RpdmVBcHAuaWRcblxubmV4dEFwcCA9IC0+IGhpZ2hsaWdodCBhY3RpdmVBcHAubmV4dFNpYmxpbmdcbnByZXZBcHAgPSAtPiBoaWdobGlnaHQgYWN0aXZlQXBwLnByZXZpb3VzU2libGluZ1xucXVpdEFwcCA9IC0+IGtsb2cgJ3F1aXRBcHAnIGFjdGl2ZUFwcC5pZFxuICAgIFxuIyAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuIyAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAgICAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuXG5vbk1vdXNlTW92ZSA9IChldmVudCkgLT4gaGlnaGxpZ2h0IGV2ZW50LnRhcmdldFxuICAgIFxub25Nb3VzZURvd24gPSAoZXZlbnQpIC0+IFxuICAgIGFjdGl2ZUFwcCA9IGV2ZW50LnRhcmdldFxuICAgIGFjdGl2YXRlKClcbiAgICAgICAgXG4jIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgMDAwICAgMDAwICAgICAgICAwMDAgMDAwICAgXG4jIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgMDAwMDAgICAgXG4jIDAwMCAgMDAwICAgMDAwICAgICAgICAgIDAwMCAgICAgXG4jIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAgIDAwMCAgICAgXG5cbm9uS2V5RG93biA9IChldmVudCkgLT4gXG4gICAgXG4gICAgeyBtb2QsIGtleSwgY2hhciwgY29tYm8gfSA9IGtleWluZm8uZm9yRXZlbnQgZXZlbnRcbiAgICBcbiAgICBzd2l0Y2gga2V5XG4gICAgICAgIHdoZW4gJ2VzYycgICB0aGVuIGRvbmUoKVxuICAgICAgICB3aGVuICdyaWdodCcgdGhlbiBuZXh0QXBwKClcbiAgICAgICAgd2hlbiAnbGVmdCcgIHRoZW4gcHJldkFwcCgpXG4gICAgICAgIHdoZW4gJ3EnICAgICB0aGVuIHF1aXRBcHAoKVxuICAgICAgICB3aGVuICdlbnRlcicgJ3JldHVybicgJ3NwYWNlJyB0aGVuIGFjdGl2YXRlKClcbiAgICAgICAgZWxzZSBrbG9nICdvbktleURvd24nIGNvbWJvXG4gICAgICAgIFxuICAgIHN3aXRjaCBjb21ib1xuICAgICAgICB3aGVuICdjdHJsK3NoaWZ0K3RhYicgdGhlbiBwcmV2QXBwKClcbiAgICAgICAgd2hlbiAnYWx0K2N0cmwrcScgICAgIHRoZW4gZWxlY3Ryb24ucmVtb3RlLmFwcC5xdWl0KClcbiAgICAgICAgXG5vbktleVVwID0gKGV2ZW50KSAtPiAgICAgICAgIFxuICAgIFxuICAgIHsgbW9kLCBrZXksIGNoYXIsIGNvbWJvIH0gPSBrZXlpbmZvLmZvckV2ZW50IGV2ZW50XG4gICAgIyBrbG9nIFwidXAgI3ttb2R9LCAje2tleX0sICN7Y2hhcn0sICN7Y29tYm99XCJcbiAgICBpZiBlbXB0eSBjb21ib1xuICAgICAgICBhY3RpdmF0ZSgpXG4gICAgICAgIFxuIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgIDAwMCAgICAgICAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICBcbiMgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIFxuIyAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgXG4jIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIDAwMCAgICAgICAwMCAgICAgMDAgIDAwMCAgMDAwICAgMDAwICBcblxuaW5pdFdpbiA9IC0+XG4gICAgXG4gICAgd2luID0gZWxlY3Ryb24ucmVtb3RlLmdldEN1cnJlbnRXaW5kb3coKVxuICAgIFxuICAgIGEgPSQgJy5hcHBzJ1xuICAgIFxuICAgIGEub25tb3VzZW1vdmUgPSBvbk1vdXNlTW92ZVxuICAgIGEub25tb3VzZWRvd24gPSBvbk1vdXNlRG93blxuICAgIGEub25rZXlkb3duICAgPSBvbktleURvd25cbiAgICBhLm9ua2V5dXAgICAgID0gb25LZXlVcFxuICAgIFxuICAgICMgaWYgbm90IHdpbi5kZWJ1Z1xuICAgICAgICAjIGEub25ibHVyID0gZG9uZVxuICAgIFxuICAgIGxvYWRBcHBzKClcbiAgICAgICAgXG4gICAgcG9zdC5vbiAnbmV4dEFwcCcgLT4gXG4gICAgICAgIFxuICAgICAgICBpZiB3aW4uaXNWaXNpYmxlKClcbiAgICAgICAgICAgIG5leHRBcHAoKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBhID0kICcuYXBwcydcbiAgICAgICAgICAgIGEuaW5uZXJIVE1MID0gJydcbiAgICAgICAgICAgIHdpbi5zaG93KClcbiAgICAgICAgICAgIGxvYWRBcHBzKClcbiAgICBcbiMgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAwMDAwMCAgICAwMDAwMDAwICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgICAgICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgIDAwMDAwMDAgICBcblxubG9hZEFwcHMgPSAtPlxuICAgIFxuICAgIGEgPSQgJy5hcHBzJ1xuICAgIGEuaW5uZXJIVE1MID0gJydcbiAgICBcbiAgICBmb3IgcCBpbiBnZXRBcHBzKClcbiAgICAgICAgYS5hcHBlbmRDaGlsZCBlbGVtICdpbWcnLFxuICAgICAgICAgICAgaWQ6IHBcbiAgICAgICAgICAgIGNsYXNzOidhcHAnIFxuICAgICAgICAgICAgc3JjOnNsYXNoLmZpbGVVcmwgcG5nUGF0aCBwXG4gICAgICAgIFxuICAgIGEuZm9jdXMoKVxuICAgIFxuICAgIGhpZ2hsaWdodCBhLmZpcnN0Q2hpbGQubmV4dFNpYmxpbmcgPyBhLmZpcnN0Q2hpbGRcbiAgICAgICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBcbiAgICBzdGFydDpzdGFydFxuICAgIGluaXRXaW46aW5pdFdpblxuICAgIFxuICAgIFxuICAgICJdfQ==
//# sourceURL=../coffee/switch.coffee